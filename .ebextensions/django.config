container_commands:
  01_create_log_folder:
    command: "sudo mkdir -p /var/log/ecsite/logs"
  02_create_log_file:
    command: "sudo touch /var/log/ecsite/logs/ecsite.log"
  03_change_permissions:
    command: "sudo chmod g+s /var/log/ecsite/logs/ecsite.log"
  04_change_owner:
    command: "chown webapp:webapp /var/log/ecsite/logs/ecsite.log"
  05_makemigrations:
    command: "python manage.py makemigrations"
  06_migrate:
    command: "python manage.py migrate"
  07_collectstatic:
    command: "python manage.py collectstatic --noinput"

option_settings:
  aws:elasticbeanstalk:application:environment:
    DJANGO_SETTINGS_MODULE: ecsite.settings.prod
  aws:elasticbeanstalk:container:python:
    WSGIPath: ecsite.wsgi:application
  aws:elasticbeanstalk:environment:proxy:staticfiles:
    StaticFiles: /collected_static