"use strict";const omikuji=()=>{const btn=document.getElementById("btn"),changelevelElem=document.getElementById("omikujiChangeLevel"),currentValueElem=document.getElementById("omikuji-current-value"),omikujiPoint=document.getElementById("omikuji_point"),omikujiPointBtn=document.getElementById("omikuji_point_btn");ajax通信におけるcsrf対策;const getCookie=name=>{if(document.cookie&&""!==document.cookie)for(const cookie of document.cookie.split(";")){const[key,value]=cookie.trim().split("=");if(key===name)return decodeURIComponent(value)}},csrftoken=getCookie("csrftoken");function setPoint(point){omikujiPoint.value=point,omikujiPoint.addEventListener("submit",e=>{e.preventDefault();const url="{% url 'games:control_omikuji_point' %}",pointReUp=document.getElementById("pointUp");fetch(url,{method:"POST",headers:{"X-CSRFToken":csrftoken}}).then(response=>(console.log(response),response.json())).then(response=>{console.log(response),pointReUp.innerText=response.user.point}).catch(error=>{console.log(error)})})}function sendPoint(e){omikujiPointBtn.click(e)}function setCurrentValue(val){currentValueElem.innerText=val}function setGame(lev){btn.addEventListener("click",()=>{let n=Math.random();1==lev?n=n:n+=2==lev?.03:3==lev?.06:4==lev?.1:.15,n<.2?(btn.textContent="大吉",setPoint(2e3)):n<.4?(btn.textContent="吉",setPoint(1e3)):n<.6?(btn.textContent="中吉",setPoint(600)):n<.8?(btn.textContent="小吉",setPoint(400)):n<1?(btn.textContent="末吉",setPoint(200)):(btn.textContent="凶",setPoint(-1500))})}function rangeOnChange(e){setCurrentValue(e.target.value),setGame(e.target.value)}console.log(csrftoken),window.onload=()=>{changelevelElem.addEventListener("input",rangeOnChange),setCurrentValue(changelevelElem.value),setGame(changelevelElem.value)}};omikuji();